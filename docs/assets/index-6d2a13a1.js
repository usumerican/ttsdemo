(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerPolicy&&(r.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?r.credentials="include":c.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(c){if(c.ep)return;c.ep=!0;const r=i(c);fetch(c.href,r)}})();addEventListener("DOMContentLoaded",async()=>{onunhandledrejection=e=>alert(e.reason||e);const l=document.title;document.querySelector(".TitleOutput").textContent=l+" 0.0.4";const n=new URLSearchParams(location.search),i=document.querySelector(".TextInput");i.value=n.get("text")||"",S();const s=document.querySelector(".PitchSelect");s.replaceChildren(...[...Array(21)].map((e,o)=>{const t=(o/10).toFixed(1);return new Option("Pitch: "+t,t)})),m(s,n.get("pitch"),"1.0");const c=document.querySelector(".RateSelect");c.replaceChildren(...[...Array(100)].map((e,o)=>{const t=((o+1)/10).toFixed(1);return new Option("Rate: "+t,t)})),m(c,n.get("rate"),"1.0");const r=document.querySelector(".VolumeSelect");r.replaceChildren(...[...Array(11)].map((e,o)=>{const t=(o/10).toFixed(1);return new Option("Volume: "+t,t)})),m(r,n.get("volume"),"1.0");const a=new Map;for(const e of(await x()).sort((o,t)=>o.lang.localeCompare(t.lang))){const o=f(e.lang);let t=a.get(o);t||(t=[],a.set(o,t)),t.push(e)}const p=document.querySelector(".LangSelect"),q=new Intl.DisplayNames([],{type:"language"});p.replaceChildren(...["",...a.keys()].map(e=>{let o;if(e){let t;try{t=q.of(e)}catch{t=e}o="["+e+"] "+t}else o="";return new Option(o,e)})),p.value=f(n.get("lang")||""),p.onchange=()=>{g()};const d=document.querySelector(".VoiceSelect");g(),d.value=n.get("voiceURI")||"";function g(){d.replaceChildren(...[{name:"",localService:!0,voiceURI:""},...a.get(p.value)||[]].map(e=>new Option(e.name+(e.localService?"":" (Remote)"),e.voiceURI)))}document.querySelector(".SpeakForm").onsubmit=e=>{var L;e.preventDefault(),h();const o=i.value,t=p.value,y=d.value,v=s.value,w=c.value,O=r.value,u=new SpeechSynthesisUtterance(o);u.lang=f(t),u.voice=(L=a.get(t))==null?void 0:L.find(P=>P.voiceURI===y),u.pitch=parseFloat(v),u.rate=parseFloat(w),u.volume=parseFloat(O),speechSynthesis.speak(u),history.replaceState(null,null,"?"+new URLSearchParams({text:o,lang:t,voiceURI:y,pitch:v,rate:w,volume:O})),S()};function S(){const e=i.value,o=30;document.title=e?e.length>o?e.slice(0,o-1)+"â€¦":e:l}document.querySelector(".StopButton").onclick=()=>{h()},onpagehide=()=>{h()},visualViewport.onresize=()=>{document.documentElement.style.height=visualViewport.height+"px",document.documentElement.scrollTop=0}});function m(l,n,i){(l.value=n)||(l.value=i)}function x(){return new Promise((l,n)=>{const i=speechSynthesis.getVoices();i.length?l(i):speechSynthesis.addEventListener("voiceschanged",()=>{x().then(s=>l(s),s=>n(s))},{once:!0})})}function h(){speechSynthesis.cancel()}function f(l){if(l.includes("_")){const n=l.split(/[^0-9a-zA-Z]+/);n.length>2&&([n[1],n[2]]=[n[2],n[1]]),l=n.join("-")}return l}
